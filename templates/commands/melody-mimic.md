---
description: 旋律风格学习助手 - 基于参考歌曲创作原创旋律
scripts:
  sh: ../../scripts/bash/melody-mimic.sh
  ps1: ../../scripts/powershell/melody-mimic.ps1
mode: mimic
---

# /melody-mimic - 旋律风格学习助手 🎼

> **核心理念**: 基于参考歌曲的 MIDI 和歌词，学习旋律风格并创作原创旋律
> **目标**: 通过分析参考乐谱的抽象特征，引导用户创作风格相似的原创作品

---

## 第一步: 运行脚本获取状态 ⚠️ 必须执行

```bash
# AI 操作: 运行脚本
bash scripts/bash/melody-mimic.sh
```

### 解析返回结果

脚本会返回:
- `song_name`: 参考歌曲名称
- `midi_path`: MIDI 文件路径
- `lyrics_path`: 歌词文件路径
- `output_dir`: 输出目录
- `action`: analyze/create/review

---

## ⚠️ 版权风险提醒

**重要声明**：

1. **旋律受版权保护**: 参考歌曲的旋律属于原作者的知识产权
2. **仅供学习参考**: 本工具生成的内容仅供个人学习和创作参考使用
3. **商用风险评估**: 如需商业使用，请自行评估版权风险并获取必要授权
4. **原创性要求**: 建议在生成内容基础上进行充分的二次创作

> 使用本命令即表示您已了解并接受上述风险提示

---

## 📁 输入文件要求

### 文件目录结构

请将参考歌曲的文件放在指定目录：

```
workspace/
└── references/
    └── {song-name}/
        ├── {song-name}.mid      # MIDI 文件（必需）
        └── {song-name}.txt      # 歌词文件（必需）
```

**示例**:
```
workspace/
└── references/
    └── tan-gu-zhi/
        ├── tan-gu-zhi.mid       # 《探故知》MIDI 文件
        └── tan-gu-zhi.txt       # 《探故知》歌词文件
```

### MIDI 文件要求

- **格式**: Standard MIDI File (SMF) Format 0 或 Format 1
- **建议**: 人声旋律放在独立音轨，音轨名包含 "vocal"、"melody" 或 "voice"
- **备注**: 如无明确命名，AI 将通过歌词字数匹配最接近的音轨

### 歌词文件格式

歌词文件使用纯文本格式，需包含段落标记：

```
[info]
title: 探故知
artist: 浅影阿
key: C
bpm: 80

[verse1]
三两笔着墨迟迟
不为记事
随手便成诗

[chorus]
多少往事随风去
化作云烟散
只留一曲探故知
```

---

## 🎵 工作流程

### 步骤 1: 人声音轨匹配

AI 将：
1. **分析 MIDI 音轨** - 识别可能的人声音轨
2. **字数匹配** - 将音符数量与歌词字数对比
3. **音域验证** - 检查是否在人声音域范围内
4. **确认选择** - 请求用户确认或手动选择音轨

### 步骤 2: 特征分析

AI 将分析：
- 🥁 **节奏型分布** - 四分、八分、附点、切分等比例
- 🎵 **音程分布** - 同度、级进、小跳、大跳比例
- 🎼 **调式推断** - 基于五声音阶的调式识别
- 📈 **旋律轮廓** - 上行、下行、平稳的分布

### 步骤 3: 歌词创作引导

AI 将：
1. **分析原歌词结构** - 段落、句数、字数统计
2. **主题输入引导** - 询问新歌主题、意象、情感基调
3. **逐段创作** - 按结构引导创作，确保字数匹配
4. **结构验证** - 检查段落、句数、字数一致性

### 步骤 4: 旋律生成

AI 将：
1. **选择借鉴程度** - 高度相似/风格借鉴/轻度参考
2. **基于特征生成** - 遵循分析出的节奏、音程、调式特征
3. **音符歌词对位** - 确保每个汉字对应一个音符
4. **输出多种格式** - 简谱、MIDI 文件

---

## 📊 分析输出示例

```
═══════════════════════════════════════════════════════════════
                    🎵 旋律特征分析报告
═══════════════════════════════════════════════════════════════

📊 基本信息
├── 调号: C
├── 拍号: 4/4
├── BPM: 80
└── 总音符数: 51

🎼 调式分析
├── 检测结果: 羽调式 (Yu)
├── 置信度: 85%
└── 情感特征: 忧伤、婉转、抒情

🥁 节奏型分布
├── 四分音符: 35%  ████████████████████
├── 八分音符: 40%  ████████████████████████
├── 附点节奏: 15%  ████████
├── 切分节奏: 8%   ████
└── 其他: 2%       █

🎵 音程分布
├── 同度: 5%    ██
├── 级进: 60%   ████████████████████████████████████
├── 小跳: 25%   ███████████████
└── 大跳: 10%   ██████

═══════════════════════════════════════════════════════════════
```

---

## 🎶 借鉴程度选项

| 模式 | 说明 | 特点 |
|------|------|------|
| **高度相似** | 严格遵循参考特征 | 节奏型比例 ±5%，音程分布 ±5% |
| **风格借鉴** | 参考整体风格 | 节奏型比例 ±15%，音程分布 ±15% |
| **轻度参考** | 仅借鉴调式和情绪 | 自由发挥，保持调式一致 |

---

## 📄 输出格式

### 生成文件

```
workspace/
└── output/
    └── {new-song-name}/
        ├── {new-song-name}.txt      # 新歌词文件
        ├── {new-song-name}.jianpu   # 简谱文件
        └── {new-song-name}.mid      # MIDI 文件
```

### 简谱示例

**重要**: 实际生成简谱时，**不要包含**版权提醒、免责声明等说明性文字，只输出纯净的简谱内容。

```
1=C 4/4  BPM=80

[主歌]
| 5  3  2  1 | 6  -  -  - | 5  6  1' 6 | 5  -  -  - |
  风 吹 过 江   南            烟 雨 朦  胧   中

[副歌]
| 1' 6  5  3 | 5  6  1' - | 6  5  3  2 | 1  -  -  - |
  多 少 往 事   随 风 去      化 作 云 烟   散
```

**生成规则**:
- ✅ 只输出：调号、拍号、BPM、段落标记、音符和歌词
- ❌ 不要添加：版权提醒、免责声明、说明性文字

---

## 💡 使用提示

### 开始前准备

1. 将参考歌曲的 MIDI 和歌词文件按要求目录结构放置
2. 确认歌词文件包含正确的段落标记
3. 了解版权风险并接受学习用途声明

### 获得最佳效果

- 选择高质量的 MIDI 文件（包含清晰的人声音轨）
- 歌词结构标记清晰完整
- 根据创作需求选择合适的借鉴程度
- 基于生成结果进行二次创作以增强原创性

---

**准备好开始你的旋律风格学习之旅了吗？** 🎶

请按要求准备文件，然后运行上面的脚本开始分析！